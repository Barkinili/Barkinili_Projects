/*******************************************************************************
 * @File       : NRF24L01.c
 * @Created_on : 29 Sep 2025
 * @Author     : Gokhan PACAL
 * @About      : STM32 HAL ile NRF24L01 Driver
 ******************************************************************************/
#include "NRF24L01.h"

/* NRF24L01 komut ve register tanımları */
#define NRF24_CMD_W_REGISTER    0x20
#define NRF24_CMD_W_TX_PAYLOAD  0xA0
#define NRF24_REG_CONFIG        0x00
#define NRF24_REG_RF_CH         0x05
#define NRF24_REG_RF_SETUP      0x06
#define NRF24_REG_TX_ADDR       0x10
#define NRF24_REG_EN_AA         0x01
#define NRF24_REG_EN_RXADDR     0x02
#define NRF24_REG_STATUS        0x07
#define NRF24_CONFIG_PWR_UP     0x02
#define NRF24_CONFIG_PRIM_TX    0x00

/* CE ve CSN kontrol fonksiyonları */
static void NRF24_CSN_High(NRF24L01_Handle_t *nrf) { HAL_GPIO_WritePin(nrf->CSN_Port, nrf->CSN_Pin, GPIO_PIN_SET); }
static void NRF24_CSN_Low(NRF24L01_Handle_t *nrf)  { HAL_GPIO_WritePin(nrf->CSN_Port, nrf->CSN_Pin, GPIO_PIN_RESET); }
static void NRF24_CE_High(NRF24L01_Handle_t *nrf)  { HAL_GPIO_WritePin(nrf->CE_Port, nrf->CE_Pin, GPIO_PIN_SET); }
static void NRF24_CE_Low(NRF24L01_Handle_t *nrf)   { HAL_GPIO_WritePin(nrf->CE_Port, nrf->CE_Pin, GPIO_PIN_RESET); }

/* SPI veri gönder/al */
static uint8_t NRF24_SPI_TransmitReceive(NRF24L01_Handle_t *nrf, uint8_t data)
{
    uint8_t recv = 0;
